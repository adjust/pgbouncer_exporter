version: '2.1'
services:
  postgresql:
    image: docker.io/bitnami/postgresql:11
    volumes:
      - 'postgresql_data:/bitnami/postgresql'
    environment:
      - 'ALLOW_EMPTY_PASSWORD=yes'

  pgbouncer:
    image: docker.io/bitnami/pgbouncer:latest
    ports:
      - 6543:6432
    environment:
      - POSTGRESQL_HOST=postgresql
      - PGBOUNCER_AUTH_TYPE=trust
      - PGBOUNCER_STATS_USERS=pgbouncer
      - PGBOUNCER_IGNORE_STARTUP_PARAMETERS=extra_float_digits
volumes:
  postgresql_data:
    driver: local
